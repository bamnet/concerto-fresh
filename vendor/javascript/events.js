// events@2.1.0 downloaded from https://ga.jspm.io/npm:@jspm/core@2.1.0/nodelibs/browser/events.js

var e={},t=false;function dew(){if(t)return e;t=true;var r=typeof Reflect==="object"?Reflect:null;var n=r&&typeof r.apply==="function"?r.apply:function ReflectApply(e,t,r){return Function.prototype.apply.call(e,t,r)};var i;i=r&&typeof r.ownKeys==="function"?r.ownKeys:Object.getOwnPropertySymbols?function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e)};function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}var o=Number.isNaN||function NumberIsNaN(e){return e!==e};function EventEmitter(){EventEmitter.init.call(this)}e=EventEmitter;e.once=once;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=void 0;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=void 0;var s=10;function checkListener(e){if(typeof e!=="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:true,get:function(){return s},set:function(e){if(typeof e!=="number"||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}});EventEmitter.init=function(){if(this._events===void 0||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||void 0};EventEmitter.prototype.setMaxListeners=function setMaxListeners(e){if(typeof e!=="number"||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");this._maxListeners=e;return this};function _getMaxListeners(e){return e._maxListeners===void 0?EventEmitter.defaultMaxListeners:e._maxListeners}EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function emit(e){var t=[];for(var r=1;r<arguments.length;r++)t.push(arguments[r]);var i=e==="error";var o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return false;if(i){var s;t.length>0&&(s=t[0]);if(s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));u.context=s;throw u}var v=o[e];if(v===void 0)return false;if(typeof v==="function")n(v,this,t);else{var a=v.length;var c=arrayClone(v,a);for(r=0;r<a;++r)n(c[r],this,t)}return true};function _addListener(e,t,r,n){var i;var o;var s;checkListener(r);o=e._events;if(o===void 0){o=e._events=Object.create(null);e._eventsCount=0}else{if(o.newListener!==void 0){e.emit("newListener",t,r.listener?r.listener:r);o=e._events}s=o[t]}if(s===void 0){s=o[t]=r;++e._eventsCount}else{typeof s==="function"?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r);i=_getMaxListeners(e);if(i>0&&s.length>i&&!s.warned){s.warned=true;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning";u.emitter=e;u.type=t;u.count=s.length;ProcessEmitWarning(u)}}return e}EventEmitter.prototype.addListener=function addListener(e,t){return _addListener(this,e,t,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(e,t){return _addListener(this,e,t,true)};function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;return arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}}function _onceWrap(e,t,r){var n={fired:false,wrapFn:void 0,target:e,type:t,listener:r};var i=onceWrapper.bind(n);i.listener=r;n.wrapFn=i;return i}EventEmitter.prototype.once=function once(e,t){checkListener(t);this.on(e,_onceWrap(this,e,t));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(e,t){checkListener(t);this.prependListener(e,_onceWrap(this,e,t));return this};EventEmitter.prototype.removeListener=function removeListener(e,t){var r,n,i,o,s;checkListener(t);n=this._events;if(n===void 0)return this;r=n[e];if(r===void 0)return this;if(r===t||r.listener===t)if(--this._eventsCount===0)this._events=Object.create(null);else{delete n[e];n.removeListener&&this.emit("removeListener",e,r.listener||t)}else if(typeof r!=="function"){i=-1;for(o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener;i=o;break}if(i<0)return this;i===0?r.shift():spliceOne(r,i);r.length===1&&(n[e]=r[0]);n.removeListener!==void 0&&this.emit("removeListener",e,s||t)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function removeAllListeners(e){var t,r,n;r=this._events;if(r===void 0)return this;if(r.removeListener===void 0){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]);return this}if(arguments.length===0){var i=Object.keys(r);var o;for(n=0;n<i.length;++n){o=i[n];o!=="removeListener"&&this.removeAllListeners(o)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}t=r[e];if(typeof t==="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function _listeners(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i==="function"?r?[i.listener||i]:[i]:r?unwrapListeners(i):arrayClone(i,i.length)}EventEmitter.prototype.listeners=function listeners(e){return _listeners(this,e,true)};EventEmitter.prototype.rawListeners=function rawListeners(e){return _listeners(this,e,false)};EventEmitter.listenerCount=function(e,t){return typeof e.listenerCount==="function"?e.listenerCount(t):listenerCount.call(e,t)};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r==="function")return 1;if(r!==void 0)return r.length}return 0}EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?i(this._events):[]};function arrayClone(e,t){var r=new Array(t);for(var n=0;n<t;++n)r[n]=e[n];return r}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){var t=new Array(e.length);for(var r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function once(e,t){return new Promise((function(r,n){function errorListener(r){e.removeListener(t,resolver);n(r)}function resolver(){typeof e.removeListener==="function"&&e.removeListener("error",errorListener);r([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,resolver,{once:true});t!=="error"&&addErrorHandlerIfEventEmitter(e,errorListener,{once:true})}))}function addErrorHandlerIfEventEmitter(e,t,r){typeof e.on==="function"&&eventTargetAgnosticAddListener(e,"error",t,r)}function eventTargetAgnosticAddListener(e,t,r,n){if(typeof e.on==="function")n.once?e.once(t,r):e.on(t,r);else{if(typeof e.addEventListener!=="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function wrapListener(i){n.once&&e.removeEventListener(t,wrapListener);r(i)}))}}return e}const r=dew();r.once;r.once=function(e,t){return new Promise(((r,n)=>{function eventListener(...t){i!==void 0&&e.removeListener("error",i);r(t)}let i;if(t!=="error"){i=t=>{e.removeListener(name,eventListener);n(t)};e.once("error",i)}e.once(t,eventListener)}))};r.on=function(e,t){const r=[];const n=[];let i=null;let o=false;const s={async next(){const e=r.shift();if(e)return createIterResult(e,false);if(i){const e=Promise.reject(i);i=null;return e}return o?createIterResult(void 0,true):new Promise(((e,t)=>n.push({resolve:e,reject:t})))},async return(){e.removeListener(t,eventHandler);e.removeListener("error",errorHandler);o=true;for(const e of n)e.resolve(createIterResult(void 0,true));return createIterResult(void 0,true)},throw(r){i=r;e.removeListener(t,eventHandler);e.removeListener("error",errorHandler)},[Symbol.asyncIterator](){return this}};e.on(t,eventHandler);e.on("error",errorHandler);return s;function eventHandler(...e){const t=n.shift();t?t.resolve(createIterResult(e,false)):r.push(e)}function errorHandler(e){o=true;const t=n.shift();t?t.reject(e):i=e;s.return()}};const{EventEmitter:n,defaultMaxListeners:i,init:o,listenerCount:s,on:u,once:v}=r;export{n as EventEmitter,r as default,i as defaultMaxListeners,o as init,s as listenerCount,u as on,v as once};

